{"version":3,"sources":["?","../src/instagramas.js","../src/jsonp.js"],"names":["exports","global","$w","window","$d","document","API_PREFIX","data","data-show-tags","attributeName","defaultValue","data-show-tags-count","data-show-likes","data-render-type","data-count","template","tag","loader","HTMLElement","_","c","o","i","length","createElement","new","e","cloneNode","isBoolean","b","valueOf","Instagramas","element","$this","this","access_token","getAttribute","undefined","removeAttribute","children","childrenLoaded","member","source","count","className","innerHTML","appendChild","setAttribute","get","create","prototype","childLoaded","ready","removeChild","callback","success","response","call","jsonp","push","Instagrama","$data","$parent","parent","render","figure","tagscaption","likescaption","a","t","img","tags","likes","type","target","href","link","alt","caption","text","src","images","renderType","url","onload","apply","arguments","showLikes","showTags","showTagsCount","replace","instagramas","querySelectorAll","namespace","_instagramas_namespace","collection","addEventListener","start","serialize","obj","prefix","str","p","hasOwnProperty","k","v","encodeURIComponent","join","load","script","done","async","onreadystatechange","readyState","parentNode","getElementsByTagName","params","query","fname","Date"],"mappings":";CAAC,SAASA,GAASC;ICSf,IAAIC,IAAKC,QACLC,IAAKC;IAIT,IAAIC,IAAa;IAMjB,IAAIC;QACAC;YACIC,eAAe;YACfC,cAAc;;QAElBC;YACIF,eAAe;YACfC,cAAc;;QAElBE;YACIH,eAAe;YACfC,cAAc;;QAElBG;YACIJ,eAAe;YACfC,cAAc;;QAElBI;YACIL,eAAe;YACfC,cAAc;;;IAQtB,IAAIK;QACAC,KAAO;QACPC,QAAU;;IAOd,IAAIC;QACAC,GAAI,SAASC;YACT,IAAIC;YACJ,KAAK,IAAIC,IAAI,GAAGA,IAAIF,EAAEG,QAAQD,KAAK,GAAG;gBAClCD,EAAED,EAAEE,MAAMlB,EAAGoB,cAAcJ,EAAEE;;YAEjC,OAAOD;YACR,OAAO,UAAU,cAAc,OAAO;QACzCI,OAAK,SAASC;YACV,OAAOR,EAAYC,EAAEO,GAAGC,UAAU;;;IAS1C,SAASC,EAAUC;QACf,cAAcA,MAAM,oBAAqBA,MAAM,mBAAmBA,EAAEC,cAAc;;IAQtF,IAAIC,IAAc,SAASC;QAEvB,IAAIC,IAAQC;QACZ,IAAIC,IAAeH,EAAQI,aAAa;QAExC,IAAID,MAAiBE,aAAaF,MAAiB,MAAM;YACrD,MAAM;eACH;YACHH,EAAQM,gBAAgB;;QAG5BL,EAAMD,UAAUA;QAChBC,EAAMM;QACNN,EAAMO,iBAAiB;QAEvB,KAAK,IAAIC,KAAUlC,GAAM;YACrB0B,EAAM1B,EAAKkC,GAAQhC,iBAAkBmB,EAAUrB,EAAKkC,GAAQ/B,gBAC5DsB,EAAQI,aAAaK,OAAY,UAAUlC,EAAKkC,GAAQ/B,eACpDsB,EAAQI,aAAaK,MAAWlC,EAAKkC,GAAQ/B;;QAGrD,IAAIgC,IAASpC,IAAa,WAAW2B,EAAMU,QAAQ,UAAU,kBAAkBR;QAE/EF,EAAMhB,SAASC,EAAYO,IAAI;QAE/BQ,EAAMhB,OAAO2B,YAAY;QACzBX,EAAMhB,OAAO4B,YAAY9B,EAASE;QAClCgB,EAAMD,QAAQc,YAAYb,EAAMhB;QAChCgB,EAAMD,QAAQe,aAAa,cAAc;QAEzCd,EAAMe,IAAIN,GAAQT,EAAMgB;;IAO5BlB,EAAYmB,UAAUC,cAAc;QAChC,IAAIlB,IAAQC;QACZ,IAAID,EAAMM,SAAShB,WAAWU,EAAMO,gBAAgB;YAChDP,EAAMO,iBAAiB;mBAChBP,EAAMO;YACb,OAAOP,EAAMmB;;QAEjBnB,EAAMO,kBAAkB;QACxB,OAAOP;;IAMXF,EAAYmB,UAAUE,QAAQ;QAC1B,IAAInB,IAAQC;QACZD,EAAMD,QAAQe,aAAa,cAAc;QACzCd,EAAMD,QAAQqB,YAAYpB,EAAMhB;QAChC,OAAOgB;;IASXF,EAAYmB,UAAUF,MAAM,SAASN,GAAQY;QACzC,IAAIrB,IAAQC;QACZD,EAAMD,QAAQe,aAAa,cAAc;QAEzC,SAASQ,EAAQC;YACbvB,EAAMD,QAAQe,aAAa,cAAc;YACzCO,EAASG,KAAKxB,GAAOuB;;QAEzB,OAAOE,MAAMV,IAAIN,GAAQa;;IAQ7BxB,EAAYmB,UAAUD,SAAS,SAASO;QACpC,IAAIvB,IAAQC;QACZ,IAAIZ;QACJ,KAAKkC,EAASjD,MAAM;YAChB;;QAEJ,KAAKe,IAAI,GAAGA,IAAIkC,EAASjD,KAAKgB,QAAQD,KAAK,GAAG;YAC1CW,EAAMM,SAASoB,KAAK,IAAIC,EAAWJ,EAASjD,KAAKe,IAAIW;;QAEzDA,EAAMD,QAAQe,aAAa,cAAc;;IAS7C,IAAIa,IAAa,SAASC,GAAOC;QAE7B,KAAKD,GAAO;YACR,OAAO3B;;QAGX,IAAID,IAAQC;QACZD,EAAM8B,SAASD;QACf7B,EAAM1B,OAAOsD;QACb5B,EAAM+B;QAEN,OAAO/B;;IAQX2B,EAAWV,UAAUc,SAAS;QAE1B,IAAI/B,IAAQC,MACR+B,GACAC,GACAC,GACAC,GAAG9C,GAAG+C,GAAGC,GACTC,IAAO,IACPC,IAAQ;QAEZP,IAAS/C,EAAYO,IAAI;QACzBwC,EAAOrB,YAAY,gBAAgBX,EAAM1B,KAAKkE;QAG9CL,IAAIlD,EAAYO,IAAI;QACpB2C,EAAEM,SAAS;QACXN,EAAExB,YAAY;QACdwB,EAAEO,OAAO1C,EAAM1B,KAAKqE;QACpBX,EAAOnB,YAAYsB;QAEnBE,IAAMpD,EAAYO,IAAI;QACtB6C,EAAIO,MAAM5C,EAAM1B,KAAKuE,QAAQC;QAC7BT,EAAIU,MAAM/C,EAAM1B,KAAK0E,OAAOhD,EAAM8B,OAAOmB,YAAYC;QACrDb,EAAIc,SAAS;YACTnD,EAAM8B,OAAOZ,YAAYkC,MAAMpD,EAAM8B,QAAQuB;;QAEjDlB,EAAEtB,YAAYwB;QAGd,IAAIrC,EAAM8B,OAAOwB,WAAW;YACxBpB,IAAejD,EAAYO,IAAI;YAC/B0C,EAAavB,YAAY;YACzBuB,EAAatB,YAAYZ,EAAM1B,KAAKiE,MAAM7B;YAC1CyB,EAAEtB,YAAYqB;;QAIlB,IAAIlC,EAAM8B,OAAOyB,UAAU;YACvBnB,IAAIpC,EAAM8B,OAAO0B,iBAAiBxD,EAAM1B,KAAKgE,KAAKhD;YAClD,KAAKD,IAAI,GAAGA,IAAI+C,GAAG/C,KAAK,GAAG;gBACvB,KAAKW,EAAM1B,KAAKgE,KAAKjD,IAAI;oBACrB;;gBAEJiD,KAAQxD,EAASC,IAAI0E,QAAQ,WAAWzD,EAAM1B,KAAKgE,KAAKjD;;YAE5D4C,IAAchD,EAAYO,IAAI;YAC9ByC,EAAYtB,YAAY;YACxBsB,EAAYrB,YAAY0B;YACxBH,EAAEtB,YAAYoB;;QAGlBjC,EAAM8B,OAAO/B,QAAQc,YAAYmB;QAEjC,OAAOhC;;IAOX,IAAI0D,IAAcvF,EAAGwF,iBAAiB;IACtC,IAAID,MAAgBtD,aAAasD,MAAgB,MAAM;QAOnD,IAAIE,IAAY3F,EAAG4F,0BAA0B;QAM7C5F,EAAG2F;YACCE;;QAMJ3F,EAAG4F,iBAAiB,oBAAoB,SAASC;YAC7C,KAAK,IAAI3E,IAAI,GAAGA,IAAIqE,EAAYpE,QAAQD,KAAK,GAAG;gBAC5CpB,EAAG2F,GAAWE,WAAWpC,KAAK,IAAI5B,EAAY4D,EAAYrE;;;;ICnRtE,IAAIqB,IAAQ;IAEZ,SAASuD,EAAUC,GAAKC;QAEpB,IAAIC;QACJ,KAAI,IAAIC,KAAKH,GAAK;YACd,IAAIA,EAAII,eAAeD,IAAI;gBACvB,IAAIE,IAAIJ,IAASA,IAAS,MAAME,IAAI,MAAMA,GAAGG,IAAIN,EAAIG;gBACrDD,EAAI1C,YAAY8C,KAAK,WACjBP,EAAUO,GAAGD,KACbE,mBAAmBF,KAAK,MAAME,mBAAmBD;;;QAG7D,OAAOJ,EAAIM,KAAK;;IAGpB,SAASC,EAAKzB;QAEV,IAAI0B,IAASxG,SAASmB,cAAc,WACpCsF,IAAO;QACPD,EAAO7B,MAAMG;QACb0B,EAAOE,QAAQ;QACfF,EAAOzB,SAASyB,EAAOG,qBAAqB;YACxC,KAAKF,OAAU5E,KAAK+E,cAAc/E,KAAK+E,eAAe,YAAY/E,KAAK+E,eAAe,aAAa;gBAC/FH,IAAO;gBACPD,EAAOzB,SAASyB,EAAOG,qBAAqB;gBAC5C,IAAKH,KAAUA,EAAOK,YAAa;oBAC/BL,EAAOK,WAAW7D,YAAawD;;;;QAI3CxG,SAAS8G,qBAAqB,QAAQ,GAAGrE,YAAY+D;;IAGzD,SAAS7D,EAAImC,GAAKiC,GAAQ9D;QACtB,IAAI+D,IAAQ;QACZ,WAAWD,MAAW,qBAAqB9D,MAAa,aAAa;YACjEA,IAAW8D;eACR;YACHC,IAAQnB,EAAUkB;;QAEtBzE,KAAS;QACT,IAAI2E,IAAQ,YAAY,MAAM,IAAIC,OAAOzF,YAAYa;QACrDxC,OAAOmH,KAAS,SAAU9D;YACtBF,KAAYA,EAASE;YACrB;uBACWrD,OAAOmH;cAChB,OAAO5F;YACTvB,OAAOmH,KAAS;;QAEpBV,EAAKzB,IAAMkC,IAAQ,mBAAmBC;;IAG1CnH,OAAOuD;QACHV,KAAKA;;IF9DoC/C,EAAO,UAAUD;OAAgB;IAAW,OAAOkC","file":"instagramas.js","sourcesContent":[null,"/*!\n * Instagrams.js\n *\n * Renders latest instagramas\n * @require jsonp.js\n */\n\n// (function($w, $d) {\n\n    var $w = window,\n        $d = document;\n\n    // 'use strict';\n\n    var API_PREFIX = 'https://api.instagram.com/v1/users/self/media/recent/?';\n\n    /**\n     * Default properties and values\n     * @private @const data\n     */\n    var data = {\n        'data-show-tags': {\n            attributeName: 'showTags',\n            defaultValue: false\n        },\n        'data-show-tags-count': {\n            attributeName: 'showTagsCount',\n            defaultValue: 1\n        },\n        'data-show-likes': {\n            attributeName: 'showLikes',\n            defaultValue: false\n        },\n        'data-render-type': {\n            attributeName: 'renderType',\n            defaultValue: 'thumbnail'\n        },\n        'data-count': {\n            attributeName: 'count',\n            defaultValue: 5\n        }\n    };\n\n    /**\n     * Templates map\n     * @private @const template\n     */\n    var template = {\n        'tag': '<span class=\"instagrama-tag\">{{tag}}</span>',\n        'loader': '<div class=\"spinner\"><div class=\"dot1\"></div><div class=\"dot2\"></div></div>'\n    };\n\n    /**\n     * DOM elements cache\n     * @private @const elements\n     */\n    var HTMLElement = {\n        _: (function(c) {\n            var o = {};\n            for (var i = 0; i < c.length; i += 1) {\n                o[c[i]] = $d.createElement(c[i]);\n            }\n            return o;\n        }(['div', 'figure', 'figcaption', 'img', 'a'])),\n        new: function(e) {\n            return HTMLElement._[e].cloneNode(false);\n        }\n    };\n\n    /**\n     * Returns if a variable is a boolean\n     * @private @function isBoolean\n     * @return {boolean} true if the passed variable is boolean\n     */\n    function isBoolean(b) {\n        return typeof b === 'boolean' || (typeof b === 'object' && typeof b.valueOf() === 'boolean');\n    }\n\n    /**\n     * Creates a gallery of Instagramas using a valid Instagram access token\n     * @private @class Instagramas\n     * @param {HTMLElement} element - Placeholder element for Instagramas gallery\n     */\n    var Instagramas = function(element) {\n\n        var $this = this;\n        var access_token = element.getAttribute('data-access-token');\n\n        if (access_token === undefined || access_token === null) {\n            throw (\"Instagramas missing access token: Instagramas needs access token to fetch information from instragram.\");\n        } else {\n            element.removeAttribute('data-access-token');\n        }\n\n        $this.element = element;\n        $this.children = [];\n        $this.childrenLoaded = 1;\n\n        for (var member in data) {\n            $this[data[member].attributeName] = (isBoolean(data[member].defaultValue)) ?\n            element.getAttribute(member) === \"true\" || data[member].defaultValue :\n                element.getAttribute(member) || data[member].defaultValue;\n        }\n\n        var source = API_PREFIX + 'count=' + $this.count + '&amp;' + 'access_token=' + access_token;\n\n        $this.loader = HTMLElement.new('div');\n        // $this.loader = $d.createElement('div');\n        $this.loader.className = 'loader';\n        $this.loader.innerHTML = template.loader;\n        $this.element.appendChild($this.loader);\n        $this.element.setAttribute('data-state', 'initiated');\n\n        $this.get(source, $this.create);\n    };\n\n    /**\n     * @public @method childLoaded\n     * @return this\n     */\n    Instagramas.prototype.childLoaded = function() {\n        var $this = this;\n        if ($this.children.length === $this.childrenLoaded) {\n            $this.childrenLoaded = null;\n            delete $this.childrenLoaded;\n            return $this.ready();\n        }\n        $this.childrenLoaded += 1;\n        return $this;\n    };\n    /**\n     * @public @method ready\n     * @return this\n     */\n    Instagramas.prototype.ready = function() {\n        var $this = this;\n        $this.element.setAttribute('data-state', 'ready');\n        $this.element.removeChild($this.loader);\n        return $this;\n    };\n\n    /**\n     * Gets from the provided source though JSONP and executes the callback\n     * @public @method get\n     * @param {string} source - URL of the source of content\n     * @return {object} jsonp - JSON-P loader\n     */\n    Instagramas.prototype.get = function(source, callback) {\n        var $this = this;\n        $this.element.setAttribute('data-state', 'get:in-progress');\n        // TODO: Handle error cases\n        function success(response) {\n            $this.element.setAttribute('data-state', 'get:success');\n            callback.call($this, response);\n        }\n        return jsonp.get(source, success);\n    };\n\n    /**\n     * Creates the gallery content from the provided Instagram's API response.\n     * @public @method create\n     * @param {object} response - Instagram's API response object.\n     */\n    Instagramas.prototype.create = function(response) {\n        var $this = this;\n        var i;\n        if (!response.data) {\n            return;\n        }\n        for (i = 0; i < response.data.length; i += 1) {\n            $this.children.push(new Instagrama(response.data[i], $this));\n        }\n        $this.element.setAttribute('data-state', 'created');\n    };\n\n    /**\n     * Creates a single Instagram picture\n     * @private @class Instagrama\n     * @param {object} $data - Object that describe a picture from Instragram's API Response.\n     * @return {object} $this - Instagrama instance\n     */\n    var Instagrama = function($data, $parent) {\n\n        if (!$data) {\n            return this;\n        }\n\n        var $this = this;\n        $this.parent = $parent;\n        $this.data = $data;\n        $this.render();\n\n        return $this;\n    };\n\n    /**\n     * Renders the content of the picture\n     * @public @method render\n     * @return {object} $this - Instagrama instance\n     */\n    Instagrama.prototype.render = function() {\n\n        var $this = this,\n            figure,\n            tagscaption,\n            likescaption,\n            a, i, t, img,\n            tags = '',\n            likes = 0;\n\n        figure = HTMLElement.new('figure');\n        figure.className = 'instagrama-' + $this.data.type;\n\n        // a = $d.createElement('a');\n        a = HTMLElement.new('a');\n        a.target = '_blank';\n        a.className = 'instagrama';\n        a.href = $this.data.link;\n        figure.appendChild(a);\n\n        img = HTMLElement.new('img');\n        img.alt = $this.data.caption.text;\n        img.src = $this.data.images[$this.parent.renderType].url;\n        img.onload = function() {\n            $this.parent.childLoaded.apply($this.parent, arguments);\n        };\n        a.appendChild(img);\n\n        // likes\n        if ($this.parent.showLikes) {\n            likescaption = HTMLElement.new('figcaption');\n            likescaption.className = 'instagrama-likes';\n            likescaption.innerHTML = $this.data.likes.count;\n            a.appendChild(likescaption);\n        }\n\n        // collect tags\n        if ($this.parent.showTags) {\n            t = $this.parent.showTagsCount || $this.data.tags.length;\n            for (i = 0; i < t; i += 1) {\n                if (!$this.data.tags[i]) {\n                    continue;\n                }\n                tags += template.tag.replace('{{tag}}', $this.data.tags[i]);\n            }\n            tagscaption = HTMLElement.new('figcaption');\n            tagscaption.className = 'instagrama-tags';\n            tagscaption.innerHTML = tags;\n            a.appendChild(tagscaption);\n        }\n\n        $this.parent.element.appendChild(figure);\n\n        return $this;\n    };\n\n    /*\n    * @private\n    * Will find all instances of instagramas in the document\n    */\n    var instagramas = $d.querySelectorAll('.instagramas');\n    if (instagramas !== undefined || instagramas !== null) {\n        /**\n        * @private\n        * Instagramas namespace can be predefined by setting a string in the global\n        * variable `_instagramas_namespace` with the name of your choosing, otherwise\n        * will automatically use the defautl value `_Instagramas`.\n        */\n        var namespace = $w._instagramas_namespace || '_Instagramas';\n\n        /**\n        * @public\n        * Define the namespace to store instagramas instances.\n        */\n        $w[namespace] = {\n            collection: []\n        };\n\n        /*\n        * Start, when DOM ready, create a Instagramas instance for each match.\n        */\n        $d.addEventListener(\"DOMContentLoaded\", function start() {\n            for (var i = 0; i < instagramas.length; i += 1) {\n                $w[namespace].collection.push(new Instagramas(instagramas[i]));\n            }\n        });\n    }\n\n// }(window, document));","/*!\n * jsonp.js\n */\n\n// (function(window, document) {\n\n    // 'use strict';\n\n    var count = 0;\n\n    function serialize(obj, prefix) {\n\n        var str = [];\n        for(var p in obj) {\n            if (obj.hasOwnProperty(p)) {\n                var k = prefix ? prefix + \"[\" + p + \"]\" : p, v = obj[p];\n                str.push(typeof v == \"object\" ?\n                    serialize(v, k) :\n                    encodeURIComponent(k) + \"=\" + encodeURIComponent(v));\n            }\n        }\n        return str.join(\"&\");\n    }\n\n    function load(url) {\n\n        var script = document.createElement('script'),\n        done = 0;\n        script.src = url;\n        script.async = true;\n        script.onload = script.onreadystatechange = function() {\n            if (!done && (!this.readyState || this.readyState === \"loaded\" || this.readyState === \"complete\")) {\n                done = true;\n                script.onload = script.onreadystatechange = null;\n                if ( script && script.parentNode ) {\n                    script.parentNode.removeChild( script );\n                }\n            }\n        };\n        document.getElementsByTagName('head')[0].appendChild(script);\n    }\n\n    function get(url, params, callback) {\n        var query = '';\n        if (typeof params === 'function' && typeof callback === 'undefined') {\n            callback = params;\n        } else {\n            query = serialize(params);\n        }\n        count += 1;\n        var fname = 'phealer' + '_' + new Date().valueOf() + count;\n        window[fname] = function (response) {\n            callback && callback(response);\n            try {\n                delete window[fname];\n            } catch (e) {}\n            window[fname] = null;\n        }\n        load(url + query + \"&amp;callback=\" + fname);\n    }\n\n    window.jsonp = {\n        get: get\n    };\n\n// }(window, document));"]}